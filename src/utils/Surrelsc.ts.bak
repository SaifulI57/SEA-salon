import { Surreal } from 'surrealdb.js';
import dotenv from 'dotenv';

dotenv.config();

const db = new Surreal();

const cek_null = (list_ar: any[]) => {
    let found_obj = 0;

    for (let i of list_ar) {
        for (let j of i) {
            console.log(j);
            if (typeof j == 'object') {
                found_obj += 1;
            }
        }
    }
    return found_obj ? true : false;
};

const username: string = process.env.username_surr || '';
const password: string = process.env.password_surr || '';
const uri: string = process.env.url_surreal || '';
const ns: string = process.env.ns || '';
const db_surr: string = process.env.db || '';

const init = async (): Promise<Surreal> => {
    try {
        await db.connect(uri);
        await db.use({
            namespace: 'test',
            database: 'test'
        });
        await db.signin({
            username: 'root',
            password: 'apalah'
        });
        console.info('Connected to Surrealdb');
        return db;
    } catch (e) {
        console.log(e);
        return db;
    }
};

export default { init, cek_null };
